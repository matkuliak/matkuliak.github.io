<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1199px" preserveAspectRatio="none" style="width:1048px;height:1199px;" version="1.1" viewBox="0 0 1048 1199" width="1048px" zoomAndPan="magnify"><defs><filter height="300%" id="f1g2kas2jn5ak5" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="381" x="331.5" y="28.708">Application of template to Uniconfig nodes</text><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="973.3828" style="stroke:#A80036;stroke-width:1.0;" width="10" x="269" y="133.25"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="973.3828" style="stroke:#A80036;stroke-width:1.0;" width="10" x="495" y="133.25"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="844.7188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="641.5" y="223.7813"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="973.3828" style="stroke:#A80036;stroke-width:1.0;" width="10" x="798" y="133.25"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="657.7578" style="stroke:#A80036;stroke-width:1.0;" width="10" x="947" y="371.6094"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="309" x="433" y="495.3047"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="303" x="433" y="628.9688"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="112.3984" style="stroke:#000000;stroke-width:2.0;" width="477" x="557" y="689.2344"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="206.7344" style="stroke:#000000;stroke-width:2.0;" width="601" x="433" y="815.6328"/><rect fill="#FFFFFF" height="102.2031" style="stroke:none;stroke-width:1.0;" width="601" x="433" y="920.1641"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="48" x2="48" y1="123.25" y2="1115.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="273.5" x2="273.5" y1="123.25" y2="1115.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="500" x2="500" y1="123.25" y2="1115.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="646" x2="646" y1="225.2969" y2="1115.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="803" x2="803" y1="123.25" y2="1115.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="952" x2="952" y1="373.125" y2="1115.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="5" y="119.9482">Application</text><ellipse cx="48" cy="49.9531" fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M48,57.9531 L48,84.9531 M35,65.9531 L61,65.9531 M48,84.9531 L35,99.9531 M48,84.9531 L61,99.9531 " fill="none" filter="url(#f1g2kas2jn5ak5)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="5" y="1127.6279">Application</text><ellipse cx="48" cy="1140.9297" fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M48,1148.9297 L48,1175.9297 M35,1156.9297 L61,1156.9297 M48,1175.9297 L35,1190.9297 M48,1175.9297 L61,1190.9297 " fill="none" filter="url(#f1g2kas2jn5ak5)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="81" x="231.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="238.5" y="107.9482">Uniconfig</text><rect fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="81" x="231.5" y="1114.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="238.5" y="1134.6279">Uniconfig</text><rect fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="110" x="443" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="450" y="107.9482">TaskManager</text><rect fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="110" x="443" y="1114.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="450" y="1134.6279">TaskManager</text><rect fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="155" x="567" y="1114.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="574" y="1134.6279">ApplyTemplateTask</text><rect fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="736" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="743" y="107.9482">DOMDataBroker</text><rect fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="130" x="736" y="1114.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="116" x="743" y="1134.6279">DOMDataBroker</text><rect fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="140" x="880" y="1114.6328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="887" y="1134.6279">DOMReadWriteTx</text><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="973.3828" style="stroke:#A80036;stroke-width:1.0;" width="10" x="269" y="133.25"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="973.3828" style="stroke:#A80036;stroke-width:1.0;" width="10" x="495" y="133.25"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="844.7188" style="stroke:#A80036;stroke-width:1.0;" width="10" x="641.5" y="223.7813"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="973.3828" style="stroke:#A80036;stroke-width:1.0;" width="10" x="798" y="133.25"/><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="657.7578" style="stroke:#A80036;stroke-width:1.0;" width="10" x="947" y="371.6094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="267" x2="257" y1="184.6484" y2="180.6484"/><line style="stroke:#A80036;stroke-width:1.0;" x1="267" x2="257" y1="184.6484" y2="188.6484"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48" x2="268" y1="184.6484" y2="184.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="55" y="149.3169">apply-template RPC</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="59" y="164.4497">(template ID, target uniconfig</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="59" y="179.5825">nodes with set variables)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="565" x2="555" y1="213.7813" y2="209.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="565" x2="555" y1="213.7813" y2="217.7813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="279" x2="566" y1="213.7813" y2="213.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="286" y="208.7153">new</text><rect fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="155" x="567" y="192.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="141" x="574" y="212.6436">ApplyTemplateTask</text><line style="stroke:#A80036;stroke-width:1.0;" x1="493" x2="483" y1="274.2109" y2="270.2109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="493" x2="483" y1="274.2109" y2="278.2109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="494" y1="274.2109" y2="274.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="286" y="254.0122">schedule apply-template</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="290" y="269.145">task (target uniconfig nodes)</text><polygon fill="#A80036" points="629.5,299.3438,639.5,303.3438,629.5,307.3438,633.5,303.3438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="505" x2="635.5" y1="303.3438" y2="303.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="512" y="298.2778">execute</text><polygon fill="#A80036" points="786,328.4766,796,332.4766,786,336.4766,790,332.4766" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="792" y1="332.4766" y2="332.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="658.5" y="327.4106">create r/w tx</text><line style="stroke:#A80036;stroke-width:1.0;" x1="878" x2="868" y1="361.6094" y2="357.6094"/><line style="stroke:#A80036;stroke-width:1.0;" x1="878" x2="868" y1="361.6094" y2="365.6094"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="808" x2="879" y1="361.6094" y2="361.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="815" y="356.5435">new</text><rect fill="#FEFECE" filter="url(#f1g2kas2jn5ak5)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="140" x="880" y="340.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="887" y="360.4717">DOMReadWriteTx</text><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="661.5" y1="406.9063" y2="402.9063"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="661.5" y1="406.9063" y2="410.9063"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="651.5" x2="797" y1="406.9063" y2="406.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="13" x="668.5" y="401.8403">tx</text><line style="stroke:#A80036;stroke-width:1.0;" x1="945" x2="935" y1="451.1719" y2="447.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="945" x2="935" y1="451.1719" y2="455.1719"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="946" y1="451.1719" y2="451.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="658.5" y="430.9731">read target Uniconfig nodes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="662.5" y="446.106">(CONFIG datastore)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="661.5" y1="480.3047" y2="476.3047"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="661.5" y1="480.3047" y2="484.3047"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="651.5" x2="946" y1="480.3047" y2="480.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="668.5" y="475.2388">uniconfig nodes</text><path d="M433,495.3047 L502,495.3047 L502,502.3047 L492,512.3047 L433,512.3047 L433,495.3047 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="309" x="433" y="495.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="448" y="508.3716">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="220" x="517" y="507.5151">[some Uniconfig nodes don't exist]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="505" x2="515" y1="533.5703" y2="529.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="505" x2="515" y1="533.5703" y2="537.5703"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="505" x2="640.5" y1="533.5703" y2="533.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="522" y="528.5044">failed response</text><line style="stroke:#A80036;stroke-width:1.0;" x1="945" x2="935" y1="584.8359" y2="580.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="945" x2="935" y1="584.8359" y2="588.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="946" y1="584.8359" y2="584.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="658.5" y="564.6372">read template configuration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191" x="662.5" y="579.77">container (CONFIG datastore)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="661.5" y1="613.9688" y2="609.9688"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="661.5" y1="613.9688" y2="617.9688"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="651.5" x2="946" y1="613.9688" y2="613.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="668.5" y="608.9028">template</text><path d="M433,628.9688 L502,628.9688 L502,635.9688 L492,645.9688 L433,645.9688 L433,628.9688 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="46.2656" style="stroke:#000000;stroke-width:2.0;" width="303" x="433" y="628.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="448" y="642.0356">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="148" x="517" y="641.1792">[template doesn't exist]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="505" x2="515" y1="667.2344" y2="663.2344"/><line style="stroke:#A80036;stroke-width:1.0;" x1="505" x2="515" y1="667.2344" y2="671.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="505" x2="640.5" y1="667.2344" y2="667.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="522" y="662.1685">failed response</text><path d="M557,689.2344 L633,689.2344 L633,696.2344 L623,706.2344 L557,706.2344 L557,689.2344 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="112.3984" style="stroke:#000000;stroke-width:2.0;" width="477" x="557" y="689.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="572" y="702.3013">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="202" x="648" y="701.4448">[for each target Uniconfig node]</text><rect fill="#FFFFFF" filter="url(#f1g2kas2jn5ak5)" height="40.2656" style="stroke:#000000;stroke-width:2.0;" width="459" x="564" y="731.3672"/><polygon fill="#EEEEEE" points="564,731.3672,630,731.3672,630,738.3672,620,748.3672,564,748.3672,564,731.3672" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="577" y="745.4341">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="684" y="764.4341">Processing template configuration</text><path d="M433,815.6328 L497,815.6328 L497,822.6328 L487,832.6328 L433,832.6328 L433,815.6328 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="206.7344" style="stroke:#000000;stroke-width:2.0;" width="601" x="433" y="815.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="448" y="828.6997">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="270" x="512" y="827.8433">[templates have been successfully applied]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="945" x2="935" y1="853.8984" y2="849.8984"/><line style="stroke:#A80036;stroke-width:1.0;" x1="945" x2="935" y1="853.8984" y2="857.8984"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="946" y1="853.8984" y2="853.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="658.5" y="848.8325">submit changes</text><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="661.5" y1="883.0313" y2="879.0313"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="661.5" y1="883.0313" y2="887.0313"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="651.5" x2="946" y1="883.0313" y2="883.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="668.5" y="877.9653">future</text><line style="stroke:#A80036;stroke-width:1.0;" x1="505" x2="515" y1="912.1641" y2="908.1641"/><line style="stroke:#A80036;stroke-width:1.0;" x1="505" x2="515" y1="912.1641" y2="916.1641"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="505" x2="640.5" y1="912.1641" y2="912.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="522" y="907.0981">response</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="433" x2="1034" y1="921.1641" y2="921.1641"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="87" x="438" y="931.3745">[some failure]</text><polygon fill="#A80036" points="935,952.1016,945,956.1016,935,960.1016,939,956.1016" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="941" y1="956.1016" y2="956.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="658.5" y="951.0356">cancel</text><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="661.5" y1="985.2344" y2="981.2344"/><line style="stroke:#A80036;stroke-width:1.0;" x1="651.5" x2="661.5" y1="985.2344" y2="989.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="651.5" x2="946" y1="985.2344" y2="985.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="668.5" y="980.1685">ack</text><line style="stroke:#A80036;stroke-width:1.0;" x1="505" x2="515" y1="1014.3672" y2="1010.3672"/><line style="stroke:#A80036;stroke-width:1.0;" x1="505" x2="515" y1="1014.3672" y2="1018.3672"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="505" x2="640.5" y1="1014.3672" y2="1014.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="522" y="1009.3013">failed response</text><line style="stroke:#A80036;stroke-width:2.0;" x1="943" x2="961" y1="1029.3672" y2="1047.3672"/><line style="stroke:#A80036;stroke-width:2.0;" x1="943" x2="961" y1="1047.3672" y2="1029.3672"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="289" y1="1068.5" y2="1064.5"/><line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="289" y1="1068.5" y2="1072.5"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="279" x2="494" y1="1068.5" y2="1068.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="296" y="1063.4341">future with response</text><line style="stroke:#A80036;stroke-width:2.0;" x1="637.5" x2="655.5" y1="1059.5" y2="1077.5"/><line style="stroke:#A80036;stroke-width:2.0;" x1="637.5" x2="655.5" y1="1077.5" y2="1059.5"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48" x2="58" y1="1097.6328" y2="1093.6328"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48" x2="58" y1="1097.6328" y2="1101.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="48" x2="268" y1="1097.6328" y2="1097.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="65" y="1092.5669">RPC response</text><!--MD5=[b4c5e02d400daebb32534c33d67c742b]
@startuml
title "Application of template to Uniconfig nodes"

actor Application
participant Uniconfig
participant TaskManager
participant ApplyTemplateTask
participant DOMDataBroker
participant DOMReadWriteTx

activate Uniconfig
activate TaskManager
activate DOMDataBroker

Application->>Uniconfig: apply-template RPC\n (template ID, target uniconfig\n nodes with set variables)
Uniconfig- ->>ApplyTemplateTask**: new
activate ApplyTemplateTask
Uniconfig->>TaskManager: schedule apply-template\n task (target uniconfig nodes)
TaskManager->ApplyTemplateTask: execute

ApplyTemplateTask->DOMDataBroker: create r/w tx
DOMDataBroker- ->>DOMReadWriteTx**: new
activate DOMReadWriteTx
DOMDataBroker- ->>ApplyTemplateTask: tx

ApplyTemplateTask->>DOMReadWriteTx: read target Uniconfig nodes\n (CONFIG datastore)
DOMReadWriteTx- ->>ApplyTemplateTask: uniconfig nodes
opt some Uniconfig nodes don't exist
    ApplyTemplateTask- ->>TaskManager: failed response
end
ApplyTemplateTask->>DOMReadWriteTx: read template configuration\n container (CONFIG datastore)
DOMReadWriteTx- ->>ApplyTemplateTask: template
opt template doesn't exist
    ApplyTemplateTask- ->>TaskManager: failed response
end

loop for each target Uniconfig node
    |||
    ref over ApplyTemplateTask, DOMDataBroker, DOMReadWriteTx: Processing template configuration
    |||
end

alt templates have been successfully applied
    ApplyTemplateTask->>DOMReadWriteTx: submit changes
    DOMReadWriteTx- ->>ApplyTemplateTask: future
    ApplyTemplateTask- ->>TaskManager: response
else some failure
    ApplyTemplateTask->DOMReadWriteTx: cancel
    DOMReadWriteTx- ->>ApplyTemplateTask: ack
    ApplyTemplateTask- ->>TaskManager: failed response
end

destroy DOMReadWriteTx
TaskManager- ->>Uniconfig: future with response
destroy ApplyTemplateTask
Uniconfig- ->>Application: RPC response
@enduml

PlantUML version 1.2021.00(Sun Jan 10 11:25:05 CET 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>