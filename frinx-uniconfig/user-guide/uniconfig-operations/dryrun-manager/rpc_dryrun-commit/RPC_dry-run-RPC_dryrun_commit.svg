<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
     contentScriptType="application/ecmascript" contentStyleType="text/css" height="762px" preserveAspectRatio="none"
     style="width:1414px;height:762px;background:#FFFFFF;" version="1.1" viewBox="0 0 1414 762" width="1414px"
     zoomAndPan="magnify">
    <defs>
        <filter height="300%" id="fiw4dsr28pooy" width="300%" x="-1" y="-1">
            <feGaussianBlur result="blurOut" stdDeviation="2.0"/>
            <feColorMatrix in="blurOut" result="blurOut2" type="matrix"
                           values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/>
            <feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/>
            <feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/>
        </filter>
    </defs>
    <g>
        <text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="176" x="617.25"
              y="28.708">RPC dryrun commit
        </text>
        <rect fill="#FFFFFF" filter="url(#fiw4dsr28pooy)" height="613.6563" style="stroke:#A80036;stroke-width:1.0;"
              width="10" x="269" y="133.25"/>
        <rect fill="#FFFFFF" filter="url(#fiw4dsr28pooy)" height="613.6563" style="stroke:#A80036;stroke-width:1.0;"
              width="10" x="445" y="133.25"/>
        <rect fill="#FFFFFF" filter="url(#fiw4dsr28pooy)" height="613.6563" style="stroke:#A80036;stroke-width:1.0;"
              width="10" x="630.5" y="133.25"/>
        <rect fill="#FFFFFF" filter="url(#fiw4dsr28pooy)" height="613.6563" style="stroke:#A80036;stroke-width:1.0;"
              width="10" x="871.5" y="133.25"/>
        <rect fill="#FFFFFF" filter="url(#fiw4dsr28pooy)" height="540.3906" style="stroke:#000000;stroke-width:2.0;"
              width="1216" x="184.5" y="169.3828"/>
        <rect fill="#FFFFFF" filter="url(#fiw4dsr28pooy)" height="133.6641" style="stroke:#000000;stroke-width:2.0;"
              width="757" x="194.5" y="510.8438"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="48" x2="48" y1="123.25"
              y2="755.9063"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="273.5" x2="273.5" y1="123.25"
              y2="755.9063"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="449.5" x2="449.5" y1="123.25"
              y2="755.9063"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="635.5" x2="635.5" y1="123.25"
              y2="755.9063"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="876.5" x2="876.5" y1="123.25"
              y2="755.9063"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1058.5" x2="1058.5" y1="123.25"
              y2="755.9063"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1283.5" x2="1283.5" y1="123.25"
              y2="755.9063"/>
        <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="5"
              y="119.9482">Application
        </text>
        <ellipse cx="48" cy="49.9531" fill="#FEFECE" filter="url(#fiw4dsr28pooy)" rx="8" ry="8"
                 style="stroke:#A80036;stroke-width:2.0;"/>
        <path d="M48,57.9531 L48,84.9531 M35,65.9531 L61,65.9531 M48,84.9531 L35,99.9531 M48,84.9531 L61,99.9531 "
              fill="none" filter="url(#fiw4dsr28pooy)" style="stroke:#A80036;stroke-width:2.0;"/>
        <rect fill="#FEFECE" filter="url(#fiw4dsr28pooy)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;"
              width="135" x="204.5" y="87.9531"/>
        <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="211.5"
              y="107.9482">Dry-run Manager
        </text>
        <rect fill="#FEFECE" filter="url(#fiw4dsr28pooy)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;"
              width="189" x="353.5" y="87.9531"/>
        <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="175" x="360.5"
              y="107.9482">Uniconfig Node Manager
        </text>
        <rect fill="#FEFECE" filter="url(#fiw4dsr28pooy)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;"
              width="154" x="556.5" y="87.9531"/>
        <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140" x="563.5"
              y="107.9482">Dry-run mountpoint
        </text>
        <rect fill="#FEFECE" filter="url(#fiw4dsr28pooy)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;"
              width="122" x="815.5" y="83.9531"/>
        <rect fill="#FEFECE" filter="url(#fiw4dsr28pooy)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;"
              width="122" x="811.5" y="87.9531"/>
        <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="818.5"
              y="107.9482">Dry-run journal
        </text>
        <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="209" x="951.5"
              y="119.9482">uniconfig topology (CONF DS)
        </text>
        <path d="M1041,70.9531 C1041,60.9531 1059,60.9531 1059,60.9531 C1059,60.9531 1077,60.9531 1077,70.9531 L1077,96.9531 C1077,106.9531 1059,106.9531 1059,106.9531 C1059,106.9531 1041,106.9531 1041,96.9531 L1041,70.9531 "
              fill="#FEFECE" filter="url(#fiw4dsr28pooy)" style="stroke:#000000;stroke-width:1.5;"/>
        <path d="M1041,70.9531 C1041,80.9531 1059,80.9531 1059,80.9531 C1059,80.9531 1077,80.9531 1077,70.9531 "
              fill="none" style="stroke:#000000;stroke-width:1.5;"/>
        <text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="208" x="1176.5"
              y="119.9482">uniconfig topology (OPER DS)
        </text>
        <path d="M1265.5,70.9531 C1265.5,60.9531 1283.5,60.9531 1283.5,60.9531 C1283.5,60.9531 1301.5,60.9531 1301.5,70.9531 L1301.5,96.9531 C1301.5,106.9531 1283.5,106.9531 1283.5,106.9531 C1283.5,106.9531 1265.5,106.9531 1265.5,96.9531 L1265.5,70.9531 "
              fill="#FEFECE" filter="url(#fiw4dsr28pooy)" style="stroke:#000000;stroke-width:1.5;"/>
        <path d="M1265.5,70.9531 C1265.5,80.9531 1283.5,80.9531 1283.5,80.9531 C1283.5,80.9531 1301.5,80.9531 1301.5,70.9531 "
              fill="none" style="stroke:#000000;stroke-width:1.5;"/>
        <rect fill="#FFFFFF" filter="url(#fiw4dsr28pooy)" height="613.6563" style="stroke:#A80036;stroke-width:1.0;"
              width="10" x="269" y="133.25"/>
        <rect fill="#FFFFFF" filter="url(#fiw4dsr28pooy)" height="613.6563" style="stroke:#A80036;stroke-width:1.0;"
              width="10" x="445" y="133.25"/>
        <rect fill="#FFFFFF" filter="url(#fiw4dsr28pooy)" height="613.6563" style="stroke:#A80036;stroke-width:1.0;"
              width="10" x="630.5" y="133.25"/>
        <rect fill="#FFFFFF" filter="url(#fiw4dsr28pooy)" height="613.6563" style="stroke:#A80036;stroke-width:1.0;"
              width="10" x="871.5" y="133.25"/>
        <polygon fill="#A80036" points="257,150.3828,267,154.3828,257,158.3828,261,154.3828"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="48" x2="263" y1="154.3828" y2="154.3828"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="55"
              y="149.3169">RPC dry-run (target nodes)
        </text>
        <path d="M184.5,169.3828 L260.5,169.3828 L260.5,176.3828 L250.5,186.3828 L184.5,186.3828 L184.5,169.3828 "
              fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/>
        <rect fill="none" height="540.3906" style="stroke:#000000;stroke-width:2.0;" width="1216" x="184.5"
              y="169.3828"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing"
              textLength="31" x="199.5" y="182.4497">loop
        </text>
        <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing"
              textLength="137" x="275.5" y="181.5933">[for each target node]
        </text>
        <polygon fill="#A80036" points="433,203.6484,443,207.6484,433,211.6484,437,207.6484"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="439" y1="207.6484" y2="207.6484"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="286"
              y="202.5825">resolve diff
        </text>
        <polygon fill="#A80036" points="1271.5,232.7813,1281.5,236.7813,1271.5,240.7813,1275.5,236.7813"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="1277.5" y1="236.7813" y2="236.7813"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="462"
              y="231.7153">read
        </text>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="465" y1="265.9141" y2="261.9141"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="465" y1="265.9141" y2="269.9141"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="455" x2="1282.5" y1="265.9141"
              y2="265.9141"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="472"
              y="260.8481">actual topology
        </text>
        <polygon fill="#A80036" points="1047,291.0469,1057,295.0469,1047,299.0469,1051,295.0469"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="1053" y1="295.0469" y2="295.0469"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="462"
              y="289.981">read
        </text>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="465" y1="324.1797" y2="320.1797"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="465" y1="324.1797" y2="328.1797"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="455" x2="1058" y1="324.1797"
              y2="324.1797"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="472"
              y="319.1138">intended topology
        </text>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="497" y1="353.3125" y2="353.3125"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="497" x2="497" y1="353.3125" y2="366.3125"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="456" x2="497" y1="366.3125" y2="366.3125"/>
        <polygon fill="#A80036" points="466,362.3125,456,366.3125,466,370.3125,462,366.3125"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="462"
              y="348.2466">calculate diff
        </text>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="289" y1="395.4453" y2="391.4453"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="289" y1="395.4453" y2="399.4453"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="279" x2="444" y1="395.4453"
              y2="395.4453"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="296"
              y="390.3794">diff
        </text>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="321" y1="424.5781" y2="424.5781"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="321" x2="321" y1="424.5781" y2="437.5781"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="280" x2="321" y1="437.5781" y2="437.5781"/>
        <polygon fill="#A80036" points="290,433.5781,280,437.5781,290,441.5781,286,437.5781"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="286"
              y="419.5122">aggregate changes
        </text>
        <polygon fill="#A80036" points="859.5,462.7109,869.5,466.7109,859.5,470.7109,863.5,466.7109"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="865.5" y1="466.7109" y2="466.7109"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32" x="286"
              y="461.645">clear
        </text>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="289" y1="495.8438" y2="491.8438"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="289" y1="495.8438" y2="499.8438"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="279" x2="870.5" y1="495.8438"
              y2="495.8438"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="296"
              y="490.7778">ack
        </text>
        <path d="M194.5,510.8438 L270.5,510.8438 L270.5,517.8438 L260.5,527.8438 L194.5,527.8438 L194.5,510.8438 "
              fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/>
        <rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:2.0;" width="757" x="194.5"
              y="510.8438"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing"
              textLength="31" x="209.5" y="523.9106">loop
        </text>
        <text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing"
              textLength="110" x="285.5" y="523.0542">[for each change]
        </text>
        <polygon fill="#A80036" points="618.5,545.1094,628.5,549.1094,618.5,553.1094,622.5,549.1094"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="624.5" y1="549.1094" y2="549.1094"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="286"
              y="544.0435">put/merge/delete (path, data)
        </text>
        <polygon fill="#A80036" points="859.5,574.2422,869.5,578.2422,859.5,582.2422,863.5,578.2422"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="640.5" x2="865.5" y1="578.2422" y2="578.2422"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="647.5"
              y="573.1763">CLI commands / NETCONF RPCs
        </text>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="640.5" x2="650.5" y1="607.375" y2="603.375"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="640.5" x2="650.5" y1="607.375" y2="611.375"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="640.5" x2="870.5" y1="607.375"
              y2="607.375"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="657.5"
              y="602.3091">ack
        </text>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="289" y1="636.5078" y2="632.5078"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="289" y1="636.5078" y2="640.5078"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="279" x2="629.5" y1="636.5078"
              y2="636.5078"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="296"
              y="631.4419">ack
        </text>
        <polygon fill="#A80036" points="859.5,668.6406,869.5,672.6406,859.5,676.6406,863.5,672.6406"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="865.5" y1="672.6406" y2="672.6406"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="286"
              y="667.5747">read
        </text>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="289" y1="701.7734" y2="697.7734"/>
        <line style="stroke:#A80036;stroke-width:1.0;" x1="279" x2="289" y1="701.7734" y2="705.7734"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="279" x2="870.5" y1="701.7734"
              y2="701.7734"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207" x="296"
              y="696.7075">CLI commands / NETCONF RPCs
        </text>
        <polygon fill="#A80036" points="59,733.9063,49,737.9063,59,741.9063,55,737.9063"
                 style="stroke:#A80036;stroke-width:1.0;"/>
        <line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53" x2="268" y1="737.9063"
              y2="737.9063"/>
        <text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="65"
              y="732.8403">RPC response with commands
        </text><!--MD5=[f70740c965a383be06069ffef8279990]
@startuml
hide footbox
title RPC dryrun commit

actor Application
participant "Dry-run Manager"
participant "Uniconfig Node Manager"
participant "Dry-run mountpoint"
collections "Dry-run journal"
database "uniconfig topology (CONF DS)"
database "uniconfig topology (OPER DS)"

activate "Dry-run Manager"
activate "Uniconfig Node Manager"
activate "Dry-run mountpoint"
activate "Dry-run journal"

Application -> "Dry-run Manager": RPC dry-run (target nodes)
loop for each target node
    "Dry-run Manager" -> "Uniconfig Node Manager": resolve diff
    "Uniconfig Node Manager" -> "uniconfig topology (OPER DS)": read
    "uniconfig topology (OPER DS)" - ->> "Uniconfig Node Manager": actual topology
    "Uniconfig Node Manager" -> "uniconfig topology (CONF DS)": read
    "uniconfig topology (CONF DS)" - ->> "Uniconfig Node Manager": intended topology
    "Uniconfig Node Manager" -> "Uniconfig Node Manager": calculate diff
    "Uniconfig Node Manager" - ->> "Dry-run Manager": diff

    "Dry-run Manager" -> "Dry-run Manager": aggregate changes
    "Dry-run Manager" -> "Dry-run journal": clear
    "Dry-run journal" - ->> "Dry-run Manager": ack

    loop for each change
        "Dry-run Manager" -> "Dry-run mountpoint": put/merge/delete (path, data)
        "Dry-run mountpoint" -> "Dry-run journal": CLI commands / NETCONF RPCs
        "Dry-run journal" - ->> "Dry-run mountpoint" : ack
        "Dry-run mountpoint" - ->> "Dry-run Manager": ack
    end
    "Dry-run Manager" -> "Dry-run journal": read
    "Dry-run journal" - ->> "Dry-run Manager": CLI commands / NETCONF RPCs
end
"Dry-run Manager" - -> Application: RPC response with commands
@enduml

PlantUML version 1.2021.11(Sat Oct 02 15:26:11 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
-->
    </g>
</svg>