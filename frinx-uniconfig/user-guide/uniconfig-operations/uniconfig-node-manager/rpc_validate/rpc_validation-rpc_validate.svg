<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="916px" preserveAspectRatio="none" style="width:1015px;height:916px;background:#FFFFFF;" version="1.1" viewBox="0 0 1015 916" width="1015px" zoomAndPan="magnify"><defs><filter height="300%" id="fwdwzbl5nxg3j" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="115" x="448.25" y="28.708">RPC validate</text><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="767.6484" style="stroke:#A80036;stroke-width:1.0;" width="10" x="251" y="133.25"/><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="767.6484" style="stroke:#A80036;stroke-width:1.0;" width="10" x="435" y="133.25"/><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="566.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="572" y="246.7813"/><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="380.8906" style="stroke:#A80036;stroke-width:1.0;" width="10" x="701" y="432.7422"/><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="652.25" style="stroke:#000000;stroke-width:2.0;" width="868" x="133.5" y="169.3828"/><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="401.0234" style="stroke:#000000;stroke-width:2.0;" width="848" x="143.5" y="355.3438"/><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="133.6641" style="stroke:#000000;stroke-width:2.0;" width="828" x="153.5" y="499.1719"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="48" x2="48" y1="123.25" y2="909.8984"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="255.5" x2="255.5" y1="123.25" y2="909.8984"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="440" x2="440" y1="123.25" y2="909.8984"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="577" x2="577" y1="248.2969" y2="909.8984"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="706" x2="706" y1="434.2578" y2="909.8984"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="906.5" x2="906.5" y1="123.25" y2="909.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="5" y="119.9482">Application</text><ellipse cx="48" cy="49.9531" fill="#FEFECE" filter="url(#fwdwzbl5nxg3j)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M48,57.9531 L48,84.9531 M35,65.9531 L61,65.9531 M48,84.9531 L35,99.9531 M48,84.9531 L61,99.9531 " fill="none" filter="url(#fwdwzbl5nxg3j)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fwdwzbl5nxg3j)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="181" x="163.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="167" x="170.5" y="107.9482">UniconfigNodeManager</text><rect fill="#FEFECE" filter="url(#fwdwzbl5nxg3j)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="152" x="362" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="138" x="369" y="107.9482">MountpointRegistry</text><rect fill="#FEFECE" filter="url(#fwdwzbl5nxg3j)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="121" x="846.5" y="83.9531"/><rect fill="#FEFECE" filter="url(#fwdwzbl5nxg3j)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="121" x="842.5" y="87.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="107" x="849.5" y="107.9482">NetworkDevice</text><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="767.6484" style="stroke:#A80036;stroke-width:1.0;" width="10" x="251" y="133.25"/><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="767.6484" style="stroke:#A80036;stroke-width:1.0;" width="10" x="435" y="133.25"/><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="566.8516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="572" y="246.7813"/><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="380.8906" style="stroke:#A80036;stroke-width:1.0;" width="10" x="701" y="432.7422"/><polygon fill="#A80036" points="239,150.3828,249,154.3828,239,158.3828,243,154.3828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48" x2="245" y1="154.3828" y2="154.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="55" y="149.3169">validate RPC (target nodes)</text><path d="M133.5,169.3828 L209.5,169.3828 L209.5,176.3828 L199.5,186.3828 L133.5,186.3828 L133.5,169.3828 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="652.25" style="stroke:#000000;stroke-width:2.0;" width="868" x="133.5" y="169.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="148.5" y="182.4497">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="137" x="224.5" y="181.5933">[for each target node]</text><polygon fill="#A80036" points="423,203.6484,433,207.6484,423,211.6484,427,207.6484" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="429" y1="207.6484" y2="207.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="268" y="202.5825">load mountpoint</text><line style="stroke:#A80036;stroke-width:1.0;" x1="526" x2="516" y1="236.7813" y2="232.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="526" x2="516" y1="236.7813" y2="240.7813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="445" x2="527" y1="236.7813" y2="236.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="452" y="231.7153">load</text><rect fill="#FEFECE" filter="url(#fwdwzbl5nxg3j)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="94" x="528" y="215.6484"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="535" y="235.6436">Mountpoint</text><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="271" y1="282.0781" y2="278.0781"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="271" y1="282.0781" y2="286.0781"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261" x2="434" y1="282.0781" y2="282.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="278" y="277.0122">mountpoint</text><polygon fill="#A80036" points="560,307.2109,570,311.2109,560,315.2109,564,311.2109" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="566" y1="311.2109" y2="311.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="268" y="306.145">check if validation is supported</text><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="271" y1="340.3438" y2="336.3438"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="271" y1="340.3438" y2="344.3438"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261" x2="571" y1="340.3438" y2="340.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="278" y="335.2778">response</text><path d="M143.5,355.3438 L212.5,355.3438 L212.5,362.3438 L202.5,372.3438 L143.5,372.3438 L143.5,355.3438 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="401.0234" style="stroke:#000000;stroke-width:2.0;" width="848" x="143.5" y="355.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24" x="158.5" y="368.4106">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="235" x="227.5" y="367.5542">[validation is supported and enabled]</text><polygon fill="#A80036" points="560,389.6094,570,393.6094,560,397.6094,564,393.6094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="566" y1="393.6094" y2="393.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="268" y="388.5435">create transaction</text><line style="stroke:#A80036;stroke-width:1.0;" x1="634" x2="624" y1="422.7422" y2="418.7422"/><line style="stroke:#A80036;stroke-width:1.0;" x1="634" x2="624" y1="422.7422" y2="426.7422"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="582" x2="635" y1="422.7422" y2="422.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="589" y="417.6763">new</text><rect fill="#FEFECE" filter="url(#fwdwzbl5nxg3j)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="136" x="636" y="401.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="643" y="421.6045">WriteTransaction</text><rect fill="#FFFFFF" filter="url(#fwdwzbl5nxg3j)" height="40.2656" style="stroke:#000000;stroke-width:2.0;" width="187" x="160.5" y="446.9063"/><path d="M160.5,446.9063 L226.5,446.9063 L226.5,453.9063 L216.5,463.9063 L160.5,463.9063 L160.5,446.9063 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="173.5" y="460.9731">ref</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="179" y="479.9731">Calculate-diff operation</text><path d="M153.5,499.1719 L229.5,499.1719 L229.5,506.1719 L219.5,516.1719 L153.5,516.1719 L153.5,499.1719 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:2.0;" width="828" x="153.5" y="499.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31" x="168.5" y="512.2388">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="110" x="244.5" y="511.3823">[for each change]</text><polygon fill="#A80036" points="689,533.4375,699,537.4375,689,541.4375,693,537.4375" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="695" y1="537.4375" y2="537.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="268" y="532.3716">put/merge/delete (path data)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="905" x2="895" y1="566.5703" y2="562.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="905" x2="895" y1="566.5703" y2="570.5703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="711" x2="906" y1="566.5703" y2="566.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="718" y="561.5044">configure</text><line style="stroke:#A80036;stroke-width:1.0;" x1="711" x2="721" y1="595.7031" y2="591.7031"/><line style="stroke:#A80036;stroke-width:1.0;" x1="711" x2="721" y1="595.7031" y2="599.7031"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="711" x2="906" y1="595.7031" y2="595.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="728" y="590.6372">ack</text><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="271" y1="624.8359" y2="620.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="271" y1="624.8359" y2="628.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261" x2="700" y1="624.8359" y2="624.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="278" y="619.77">ack</text><line style="stroke:#A80036;stroke-width:1.0;" x1="699" x2="689" y1="660.9688" y2="656.9688"/><line style="stroke:#A80036;stroke-width:1.0;" x1="699" x2="689" y1="660.9688" y2="664.9688"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="700" y1="660.9688" y2="660.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="268" y="655.9028">validate configuration</text><line style="stroke:#A80036;stroke-width:1.0;" x1="905" x2="895" y1="690.1016" y2="686.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="905" x2="895" y1="690.1016" y2="694.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="711" x2="906" y1="690.1016" y2="690.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="718" y="685.0356">validation RPC / command</text><line style="stroke:#A80036;stroke-width:1.0;" x1="711" x2="721" y1="719.2344" y2="715.2344"/><line style="stroke:#A80036;stroke-width:1.0;" x1="711" x2="721" y1="719.2344" y2="723.2344"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="711" x2="906" y1="719.2344" y2="719.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="728" y="714.1685">ack</text><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="271" y1="748.3672" y2="744.3672"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="271" y1="748.3672" y2="752.3672"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261" x2="700" y1="748.3672" y2="748.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="39" x="278" y="743.3013">future</text><polygon fill="#A80036" points="689,780.5,699,784.5,689,788.5,693,784.5" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="695" y1="784.5" y2="784.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34" x="268" y="779.4341">close</text><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="271" y1="813.6328" y2="809.6328"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="271" y1="813.6328" y2="817.6328"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="261" x2="705" y1="813.6328" y2="813.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23" x="278" y="808.5669">ack</text><line style="stroke:#A80036;stroke-width:2.0;" x1="697" x2="715" y1="804.6328" y2="822.6328"/><line style="stroke:#A80036;stroke-width:2.0;" x1="697" x2="715" y1="822.6328" y2="804.6328"/><line style="stroke:#A80036;stroke-width:1.0;" x1="261" x2="303" y1="849.7656" y2="849.7656"/><line style="stroke:#A80036;stroke-width:1.0;" x1="303" x2="303" y1="849.7656" y2="862.7656"/><line style="stroke:#A80036;stroke-width:1.0;" x1="262" x2="303" y1="862.7656" y2="862.7656"/><polygon fill="#A80036" points="272,858.7656,262,862.7656,272,866.7656,268,862.7656" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="268" y="844.6997">collect validation results</text><line style="stroke:#A80036;stroke-width:1.0;" x1="48" x2="58" y1="891.8984" y2="887.8984"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48" x2="58" y1="891.8984" y2="895.8984"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="48" x2="250" y1="891.8984" y2="891.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="65" y="886.8325">RPC response</text><!--MD5=[9355f0f3f535f2ab7c870c140de3bf3c]
@startuml
hide footbox
title RPC validate

actor Application
participant UniconfigNodeManager
participant MountpointRegistry
participant Mountpoint
participant WriteTransaction
collections NetworkDevice

activate UniconfigNodeManager
activate MountpointRegistry

Application -> UniconfigNodeManager: validate RPC (target nodes)
loop for each target node
    UniconfigNodeManager -> MountpointRegistry: load mountpoint
    MountpointRegistry - ->> Mountpoint**: load
    activate Mountpoint
    MountpointRegistry - ->> UniconfigNodeManager: mountpoint
    UniconfigNodeManager -> Mountpoint: check if validation is supported
    Mountpoint - ->> UniconfigNodeManager: response

    opt validation is supported and enabled
        UniconfigNodeManager -> Mountpoint: create transaction
        Mountpoint - ->> WriteTransaction**: new
        activate WriteTransaction

        ref over UniconfigNodeManager
            Calculate-diff operation
        end
        loop for each change
            UniconfigNodeManager -> WriteTransaction: put/merge/delete (path data)
            WriteTransaction ->> NetworkDevice: configure
            NetworkDevice - ->> WriteTransaction: ack
            WriteTransaction - ->> UniconfigNodeManager: ack
        end

        UniconfigNodeManager ->> WriteTransaction: validate configuration
        WriteTransaction ->> NetworkDevice: validation RPC / command
        NetworkDevice - ->> WriteTransaction: ack
        UniconfigNodeManager <<- - WriteTransaction: future
    end

    UniconfigNodeManager -> WriteTransaction:close
    WriteTransaction - ->> UniconfigNodeManager:ack
    deactivate Mountpoint
    destroy WriteTransaction
end

UniconfigNodeManager -> UniconfigNodeManager: collect validation results
Application <<- - UniconfigNodeManager:RPC response
@enduml

PlantUML version 1.2021.11(Sat Oct 02 15:26:11 CEST 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>